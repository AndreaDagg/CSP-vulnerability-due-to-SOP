<!DOCTYPE html>
<html>

<head lang="en">
    <title> HOST ONE</title>
    <meta charset="utf-8">

    <!-- UNSAFE INLNE PERMETTE L'ESECUZIONE DI RISORSE INLINE SE LA RIMUOVI NOTIAMO CHE STYLE E SCRIPT VENGONO BLOCCATE E RIPORTATE NELLA CONSOLE -->
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'unsafe-inline' 'self'; script-src 'self' 'unsafe-inline'">

</head>

<body>
    <h1>Home Page del Server <h1 style="color: red;"> ONE - SANDBOX MITIGATION </h1>
    </h1>
    <div>
        <p>Questo è il server <b>ONE</b> che ospita le pagine <b>A</b>, <b>B</b>, <b>C</b> , <b>D</b>, <b>E</b>,
            <b>SUB</b> e <b>subdomian</b>.
        </p>
        <p>Cliccando su <b>A page</b> si esegue il caso in cui la pagina <b>parent ha presente CSP</b> mentre la pagina
            child non ha CSP. Si può sfruttare la pagina child per iniettare script inline in parent.</p>
        <p>Cliccando su <b>C page</b> si esegue il caso in cui la pagina <b>parent non ha presente CSP</b> mentre la
            pagina child ha CSP. Si può sfruttare la pagina parent per iniettare script in child.</p>
        <p>Cliccando su <b>E page</b> si esegue il caso in cui SOP entra in esecuzione bloccando l'accesso ad un dominio
            differente rispotto al dominio parent.</p>
    </div>
    <script>
        console.log("Prova - Passa ad A");
        function goToPage(page) {
            if (page == "A") {
                window.location.href = "A.html";
            }
            else if (page == "C") {
                window.location.href = "C.html";
            } else if (page == "E") {
                window.location.href = "E.html";
            } else if (page == "sub") {
                window.location.href = "sub.html";
            }
        }
    </script>


    <button onclick="goToPage('A')" style="
font-size: 20px;
padding: 15px 30px;
border-radius: 10px;
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
background-color: rgb(101, 101, 243);
color: white;
border: none;
cursor: pointer;
transition: 0.3s;
outline: none;
"> Vai alla pagina A </button>

    <button onclick="goToPage('C')" style="
font-size: 20px;
padding: 15px 30px;
border-radius: 10px;
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
background-color: rgb(101, 101, 243);
color: white;
border: none;
cursor: pointer;
transition: 0.3s;
outline: none;
"> Vai alla pagina C </button>

    <button onclick="goToPage('E')" style="
font-size: 20px;
padding: 15px 30px;
border-radius: 10px;
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
background-color: rgb(101, 101, 243);
color: white;
border: none;
cursor: pointer;
transition: 0.3s;
outline: none;
" disabled title="disabilitato"> Vai alla pagina E </button>

    <button onclick="goToPage('sub')" style="
       font-size: 20px;
       padding: 15px 30px;
       border-radius: 10px;
       box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
       background-color: rgb(243, 101, 101);
       color: white;
       border: none;
       cursor: pointer;
       transition: 0.3s;
       outline: none;
       " disabled title="disabilitato"> Vai alla pagina SUB </button>
</body>

</html>