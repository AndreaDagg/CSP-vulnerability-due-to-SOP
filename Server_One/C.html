<!DOCTYPE html>
<html>
    <head lang="en">
        <title> Page C - D </title>
        <meta charset="utf-8"> 
              

    </head>

    <body>
        <h1 style="color: red;">Page C - CSP NON ATTIVO - Host One </h1> 
        <p>Variabile in D.html a cui volgiamo accedere da C.html</p>

        <div>
            <iframe id="d_frame_id" src="D.html" width="1000px" height="240px"></iframe>
        </div> 
        <script>
            var secret = 10; 
            console.log( "variable value: " + secret);
            document.write("Non c'è CSP in C.html quindi riesce ad eseguire JS in D nonostante li ci sia CSP per via del SOP");
            
            //document.getElementById("d_frame_id").contentWindow.document.write("XSS!!");
            //Attendiamo che il caricamento sia completo
            window.onload = function() {
                child_frame = document.getElementById("d_frame_id");
                secret_D = child_frame.contentWindow.secret;
                console.log( "La variabile secret in D è: " + secret_D); 
                child_frame.contentWindow.postMessage(alert("Codice JS iniettato nell'iframe. La variabile SECRET di D è: " + secret_D), "*"); 
            };
            
            
            function goToIndex(){
                window.location.href = "index.html"; 
            }   
        </script>   

        
        <div style="margin-top: 10vh;">
            <button onclick="goToIndex()"> Home Page Server One </button>
        </div>
    </body>
</html> 