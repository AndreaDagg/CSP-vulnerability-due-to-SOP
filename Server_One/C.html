<!DOCTYPE html>
<html>
    <head lang="en">
        <title> Page A </title>
        <meta charset="utf-8"> 
              

    </head>

    <body>
        <h1 style="color: red;">Page C - CSP NON ATTIVO - Host One </h1> 
        <p>Variabile in D.html a cui volgiamo accedere da C.html</p>

        <div>
            <iframe id="d_frame_id" src="D.html" width="1000px" height="240px"></iframe>
        </div> 
        <script>
            var secret = 10; 
            console.log( "variable value: " + secret);
            document.write("Non c'Ã¨ CSP in C.html quindi riesce ad eseguire JS in D nonostante li ci sia CSP per via del SOP");
            document.getElementById("d_frame_id").contentWindow.postMessage(alert("Codice JS iniettato nell'iframe nonostante ci sia CSP attivo"), "*"); 
            document.getElementById("d_frame_id").contentWindow.document.write("XSS!!");
            
            function goToIndex(){
                window.location.href = "index.html"; 
            }   
        </script>   

        
        <div style="margin-top: 10vh;">
            <button onclick="goToIndex()"> Home Page Server One </button>
        </div>
    </body>
</html> 