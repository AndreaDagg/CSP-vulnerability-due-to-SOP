<!DOCTYPE html>
<html>

<head lang="en">
    <title> Page b </title>
    <meta charset="utf-8">
</head>

<body>
    <h1 style="color: red;">Page B - CSP NON ATTIVO</h1>
    <p> Scopo andare con uno script a leggere la variabile secret di A<br>
    </p>
    <script>
        window.onload = function () {
            // Accedere all'oggetto window del genitore
            var parentWindow = window.parent;
            // Ottenere il valore della variabile 'secret' dal genitore
            var secretValue = parentWindow.secret;
            // Fare qualcosa con il valore 'secretValue'
            console.log(secretValue);
            window.parent.alert("Injection: Codice JS iniettato nella parent page. La variabile SECRET di A è: " + secretValue);
            // Rendere più evidente l'attacco
            window.setTimeout(function () {
                document.body.appendChild(
                    document.createElement(
                        "p"
                    )
                ).appendChild(
                    document.createTextNode(
                        "XSS!! Codice JS proveniente da B.html ed iniettato tramite script inline nonostante nella pagina A non fossero consentiti gli script inline nel CSP!!\n\n" +
                        "PROBLEMA: il CSP in A non si applica allo script di B che quindi riesce ad eseguire il codice inline.\n\n" +
                        "LA VARIABILE SECRET di A è: " + secretValue                        
                    )
                );
            }, 3000);

        };



    </script>

</body>

</html>