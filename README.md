# CSP-vulnerability-due-to-SOP

## Server and Environment
Two server:
- Server One [http://hostone.dagg:8001](http://hostone.dagg:8001)
- Server Two [http://hostone.dagg:8002](http://hostone.dagg:8002)

### Eseguire il server 

cd nella direcorty del server:
> docker build . 

> docker-compose up 

##### Navigare nel docker server
Per accedere ai file di configurazione del server docker una volta eseguito il container: 
> docker exec -it Host_One bash

Accedere ai file che compongono il web site
> cd /var/www/html/

Accedere ai file di configurazione del web server Apache
> cd /etc/apache2/sites-available 



### Environment 2016
- [Google Chrome v.51-0-2704](https://www.slimjet.com/chrome/google-chrome-old-version.php)
- [Ubuntu 16.04](https://releases.ubuntu.com/16.04/)


### Subdomain
Nel server ONE è presente la cartella sub che conterrà il codice del sottodominio. Questo viene copiato nel container.
- Definiamo il dominio nel *Dockerfile* nel campo *ENV*
- Creaiamo il file di configurazione *subDomain.conf* e lo importiamo nella cartella */etc/apache2/sites-available/subDomain.conf* del server Apache. 
- Abilitiamo il file di configurazione: 
    > WORKDIR /etc/apache2/sites-available
    
    > RUN a2ensite subDomain.conf && service apache2 restart
      
    > *docker build .* and *docker-compose up*

    > *docker-compose up --build -d*

- Nel **DNS** locale definiamo le path custom: 
    - **Windows:** *C:\Windows\System32\drivers\etc\hosts*
    - **Ubuntu:** *cd nano /etc/hosts*
        - 127.0.0.1 hostone.dagg (nome del dominio campo environment)
        - 127.0.0.1 sub.hostone.dagg (nome definito nel .conf)
- Raggiungiamo il sito con [http://sub.hostone.dagg:8001](http://sub.hostone.dagg:8001)

### MITIGAZIONI
Le mitigazioni sono implementate singolarmente in branch differenti: 
- Mitigazione utilizzando sandboxing dei Tag iframe
>git checkout mitigation-sandbox
- Mitigazione replicando la stessa CSP in tutte le wab page 
>git checkout mitigation-replication-csp
- Mitigazione implementando CSP nell'header del server Apache
>git checkout mitigation-header
